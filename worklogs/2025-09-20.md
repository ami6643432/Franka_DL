# 2025-09-20 Worklog (intermediate)

## Changes
- Increased MAPPO network capacity (policy/value: 256-128-64), more mini-batches, and small entropy bonus for better exploration.
- Added explicit checkpoint/write intervals for predictable saving.
- Reward shaping tweaks:
  - Gate drawer opening reward by proximity and orientation alignment to enforce approach→align→open sequence.
  - Add near-handle finger-closure bonus (based on finger gap) when aligned.
  - Extra logs: |dot1|, |dot2|, gate mean, closure bonus.
- Exposed optional W&B logging via `--wandb` in `scripts/skrl/train.py` (syncs TensorBoard automatically).

## How to run
- Resume MAPPO (example):
  `python scripts/skrl/train.py --task Custom-Franka-Cabinet-Direct-v0 --algorithm MAPPO --num_envs 2048 --device cuda:0 --checkpoint <ckpt> --max_iterations 50000 --wandb`
- Play best agent (example):
  `python scripts/skrl/play.py --task Custom-Franka-Cabinet-Direct-v0 --algorithm MAPPO --num_envs 1 --device cuda:0 --checkpoint <run>/checkpoints/best_agent.pt`

## Notes
- Check `extras/log` during training for alignment sanity: `rot_dot1_mean_abs`, `rot_dot2_mean_abs`, and `gate_mean` should trend upward as policies learn to align before pulling.
